{% extends 'base.html' %}
{% load static %}

{% block title %}Novo Caso - Seleção | Sistema Jurídico{% endblock %}

{% block content %}
<div class="container" style="max-width: 900px;">
    
    <!-- HERO HEADER -->
    <div class="hero-header text-center">
        <div class="hero-icon" style="margin: 0 auto 20px;"><i class="fa-solid fa-file-circle-plus"></i></div>
        <h1 class="hero-title" style="justify-content: center;">Criar Novo Caso</h1>
        <p class="hero-subtitle text-muted" style="margin-left: 0;">Selecione o cliente e o produto para iniciar</p>
    </div>
    
    <!-- STEPPER -->
    <div class="stepper">
        <div class="step active"><div class="step-number">1</div><span class="step-label">Seleção</span></div>
        <i class="fa-solid fa-arrow-right step-arrow"></i>
        <div class="step inactive"><div class="step-number">2</div><span class="step-label">Dados</span></div>
        <i class="fa-solid fa-arrow-right step-arrow"></i>
        <div class="step inactive"><div class="step-number">3</div><span class="step-label">Finalizar</span></div>
    </div>
    
    <!-- FORM CARD -->
    <div class="card">
        <form method="post" id="selectionForm">
            {% csrf_token %}
            <div class="form-row">
                <!-- Cliente -->
                <div class="form-group">
                    <label for="cliente"><i class="fa-solid fa-building"></i> Cliente</label>
                    <select name="cliente" id="cliente" class="form-control" required>
                        <option value="">Selecione um cliente...</option>
                        {% for cliente in clientes %}<option value="{{ cliente.id }}">{{ cliente.nome }}</option>{% endfor %}
                    </select>
                </div>
                <!-- Produto -->
                <div class="form-group">
                    <label for="produto"><i class="fa-solid fa-box"></i> Produto</label>
                    <select name="produto" id="produto" class="form-control" required>
                        <option value="">Selecione um produto...</option>
                        {% for produto in produtos %}<option value="{{ produto.id }}">{{ produto.nome }}</option>{% endfor %}
                    </select>
                </div>
            </div>
            
            <!-- PREVIEW -->
            <div id="preview" class="selection-preview-box">
                <div class="selection-preview-header"><i class="fa-solid fa-circle-check"></i> Seleção Confirmada</div>
                <div class="selection-preview-grid">
                    <div>
                        <div class="info-label">Cliente</div>
                        <div id="previewCliente" class="info-value">-</div>
                    </div>
                    <div>
                        <div class="info-label">Produto</div>
                        <div id="previewProduto" class="info-value">-</div>
                    </div>
                </div>
            </div>
            
            <!-- BOTÕES -->
            <div class="form-actions">
                <a href="{% url 'casos:lista_casos' %}" class="btn btn-outline-secondary"><i class="fa-solid fa-arrow-left"></i> Cancelar</a>
                <button type="submit" class="btn btn-success" id="submitBtn" disabled>
                    <span>Continuar</span> <i class="fa-solid fa-arrow-right"></i>
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/novo_caso_selecao.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        initNovoCasoSelecao({
            cancelUrl: "{% url 'casos:lista_casos' %}"
        });
    });
</script>
{% endblock %}