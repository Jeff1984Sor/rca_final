<!-- equipamentos/templates/equipamentos/equipamento_form.html -->
{% extends 'base.html' %}
{% load static %}

{% block title %}{{ titulo }} | Sistema Jurídico{% endblock %}

{% block content %}
<div class="form-container">
    
    <!-- HERO HEADER -->
    <div class="hero-header">
        <div class="hero-content">
            <div class="hero-icon">
                <i class="fa-solid fa-laptop"></i>
            </div>
            <div class="hero-text">
                <h1>{{ titulo }}</h1>
                <p class="text-muted">Preencha os dados do equipamento abaixo.</p>
            </div>
        </div>
    </div>

    <!-- INFO BOX -->
    <div class="info-box">
        <i class="fa-solid fa-circle-info info-box-icon"></i>
        <div class="info-box-content">
            <p><strong>Dica:</strong> Campos obrigatórios são marcados com um <span style="color: var(--danger-solid);">*</span>. Use os atalhos <strong>Ctrl+S</strong> para salvar ou <strong>ESC</strong> para cancelar.</p>
        </div>
    </div>

    <!-- FORM CARD -->
    <div class="form-card">
        <form method="post" novalidate id="equipamentoForm">
            {% csrf_token %}
            
            <!-- INFORMAÇÕES BÁSICAS -->
            <div class="form-section">
                <h3 class="form-section-title"><i class="fa-solid fa-circle-info"></i> Informações Básicas</h3>
                <div class="form-row">
                    {# ✅ CORREÇÃO APLICADA AQUI EM TODOS OS INCLUDES #}
                    {% include "equipamentos/_form_field.html" with field=form.nome_item classes="full-width" %}
                    {% include "equipamentos/_form_field.html" with field=form.tipo_item %}
                    {% include "equipamentos/_form_field.html" with field=form.marca %}
                    {% include "equipamentos/_form_field.html" with field=form.modelo %}
                </div>
            </div>

            <!-- IDENTIFICAÇÃO -->
            <div class="form-section">
                <h3 class="form-section-title"><i class="fa-solid fa-id-card"></i> Identificação</h3>
                <div class="form-row">
                    {# ✅ CORREÇÃO APLICADA AQUI EM TODOS OS INCLUDES #}
                    {% include "equipamentos/_form_field.html" with field=form.numero_serie %}
                    {% include "equipamentos/_form_field.html" with field=form.patrimonio %}
                    {% include "equipamentos/_form_field.html" with field=form.nota_fiscal %}
                </div>
            </div>

            <!-- STATUS E RESPONSÁVEL -->
            <div class="form-section">
                <h3 class="form-section-title"><i class="fa-solid fa-user-gear"></i> Status e Responsável</h3>
                <div class="form-row">
                    {# ✅ CORREÇÃO APLICADA AQUI EM TODOS OS INCLUDES #}
                    {% include "equipamentos/_form_field.html" with field=form.status %}
                    {% include "equipamentos/_form_field.html" with field=form.responsavel %}
                    {% include "equipamentos/_form_field.html" with field=form.data_aquisicao %}
                </div>
            </div>

            <!-- OBSERVAÇÕES -->
            <div class="form-section">
                <h3 class="form-section-title"><i class="fa-solid fa-note-sticky"></i> Observações</h3>
                <div class="form-row">
                    <div class="form-group full-width">
                        <label for="{{ form.observacoes.id_for_label }}" class="form-label">{{ form.observacoes.label }}</label>
                        {{ form.observacoes }}
                        <div class="char-counter" id="char-counter"><span id="char-count">0</span> caracteres</div>
                        {% for error in form.observacoes.errors %}<div class="error-message">{{ error }}</div>{% endfor %}
                    </div>
                </div>
            </div>

            <!-- ACTIONS -->
            <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="submitBtn"><i class="fa-solid fa-floppy-disk"></i> Salvar Equipamento</button>
                <a href="{% url 'equipamentos:equipamento_list' %}" class="btn btn-outline-secondary"><i class="fa-solid fa-xmark"></i> Cancelar</a>
            </div>

        </form>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{% static 'js/form_equipamento.js' %}"></script>
<script>
    document.addEventListener('DOMContentLoaded', function() {
        initEquipamentoForm("{% url 'equipamentos:equipamento_list' %}");
    });
</script>
{% endblock %}