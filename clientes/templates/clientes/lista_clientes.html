{% extends 'base.html' %}

{% block title %}Gestão de Clientes{% endblock %}

{% block content %}
    <h1 style="font-size: 2.25rem; font-weight: 700; margin-bottom: 24px;">Gestão de Clientes</h1>

    <!-- Card de Filtros -->
    <div class="card">
        <form method="GET" action="{% url 'clientes:lista_clientes' %}">
            <div class="form-row" style="align-items: flex-end;">
                <div class="form-group">
                    <label for="id_filtro_nome">Filtrar por Nome</label>
                    <input id="id_filtro_nome" type="text" name="filtro_nome" placeholder="Digite parte do nome..." value="{{ filtro_nome }}">
                </div>
                <div class="form-group">
                    <label for="id_filtro_tipo">Filtrar por Tipo</label>
                    <select id="id_filtro_tipo" name="filtro_tipo">
                        <option value="">Todos os Tipos</option>
                        <option value="PF" {% if filtro_tipo == 'PF' %}selected{% endif %}>Pessoa Física</option>
                        <option value="PJ" {% if filtro_tipo == 'PJ' %}selected{% endif %}>Pessoa Jurídica</option>
                    </select>
                </div>
                <div class="form-group">
                    <div style="display: flex; gap: 10px;">
                        <button type="submit" class="btn btn-success">Filtrar</button>
                        <a href="{% url 'clientes:lista_clientes' %}" class="btn btn-secondary">Limpar</a>
                    </div>
                </div>
            </div>
        </form>
    </div>

    <!-- Barra de Ações (Exportar, Novo) -->
    <div style="display: flex; justify-content: flex-end; gap: 10px; margin-bottom: 24px;">
        <a href="{% url 'clientes:exportar_excel' %}?filtro_nome={{ filtro_nome }}&filtro_tipo={{ filtro_tipo }}" class="btn btn-info">Exportar Excel</a>
        <a href="{% url 'clientes:criar_cliente' %}" class="btn btn-primary">Criar Novo Cliente</a>
    </div>

    <!-- Card da Tabela -->
    <div class="data-table-container">
        <table class="data-table">
            <thead>
                <tr>
                    <th>Nome</th>
                    <th>Tipo</th>
                    <th>Cidade/UF</th>
                    <th>Contato (PJ)</th>
                    <th style="text-align: right;">Ações</th>
                </tr>
            </thead>
            <tbody>
                {% for cliente in clientes %}
                <tr>
                    <td>{{ cliente.nome }}</td>
                    <td>{{ cliente.get_tipo_display }}</td>
                    <td>{{ cliente.cidade|default:"-" }}/{{ cliente.uf|default:"-" }}</td>
                    <td>{{ cliente.contato_empresa|default:"-" }}</td>
                    <td class="actions">
                        <a href="{% url 'clientes:editar_cliente' pk=cliente.pk %}" class="action-btn btn-edit">Editar</a>
                        <a href="{% url 'clientes:deletar_cliente' pk=cliente.pk %}" class="action-btn btn-danger">Deletar</a>
                    </td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="5">
                        <div class="empty-state">
                            <p>Nenhum cliente encontrado.</p>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}